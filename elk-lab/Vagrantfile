# encoding: utf-8
# Vagrantfile — ELK Lab (Phase 0) — Debian Bullseye + 192.168.57.0/24
Vagrant.configure("2") do |config|
  # سیستم‌عامل پایه
  config.vm.box = "debian/bullseye64"

  # شبکه‌ی خصوصی ثابت برای همه ماشین‌ها
  NET = "192.168.57"

  # منابع پیش‌فرض کوچک برای محیط آموزشی
  DEFAULT_CPUS = 1
  DEFAULT_RAM  = 1024

  # تابع کمکی برای تعریف نودها
  def define_node(config, name, ip_octet, ram=DEFAULT_RAM, cpus=DEFAULT_CPUS)
    config.vm.define name do |node|
      node.vm.hostname = name
      node.vm.network "private_network", ip: "#{NET}.#{ip_octet}"
      node.vm.provider :virtualbox do |vb|
        vb.name   = "elk-lab-#{name}"
        vb.cpus   = cpus
        vb.memory = ram
      end
      # در صورت نیاز، هم‌مسیر کردن را بعداً فعال می‌کنیم.
      # node.vm.synced_folder ".", "/vagrant", disabled: true
    end
  end

  # نودها و IPها
  define_node(config, "lb",   10, 1024, 1)
  define_node(config, "web1", 11, 1024, 1)
  define_node(config, "web2", 12, 1024, 1)
  define_node(config, "db",   13, 1024, 1)
  define_node(config, "elk",  14, 2048, 2)  # ELK کمی رم بیشتر می‌خواهد

  # نکته: Provision در فازهای بعدی با Ansible انجام خواهد شد.
end
